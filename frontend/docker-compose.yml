version: '2'

services:

  django:
    build:
      context: ../backend
      args:
        - development=true
        - python_base=python
    command: ./manage.py runserver 0.0.0.0:8000
    entrypoint: ""
    environment:
      - DJANGO_ALLOWED_HOSTS=django
      - DJANGO_CONFIGURATION=Dev
    expose:
      - "8000"
    user: $HOST_UID
    volumes:
      - ../backend:/app

  frontend:
    build:
      context: .
      args:
        - node_base=node
        - node_env=development
    command: yarn dev
    environment:
      - NODE_ENV=development
    links:
      - django
    ports:
      - "8080:8080"
    volumes:
      - .:/usr/src/app
      - dev_cache:/home/node/.cache
      - /usr/src/app/node_modules

volumes:
  dev_cache:
